{"pageProps":{"frontmatter":{"slug":"/blog/_atomapiphotouploader","date":"Sun, 27 Mar 2005 16:05:00 GMT","title":"続続 AtomAPIPhotoUploader","epoch":"1111939500"},"markdownBody":"\nFlickrがLifeblogすなわちAtom PPに対応したってことなんで、拙作のAtomベースのアップローダもFlickrにあっさり対応...、と思いきや苦難が。\n\nまず、Flickrの認証はX-WSSEなんですが、（たしか）昔のTypePadと同じ、[NonceをBase64エンコードしない方式](https://www.xml.com/pub/a/2003/12/17/dive.html)なんで、それに対応しなければならなかった。\n\nまあそれはすでに通った道なんですぐに対応できたものの、いくらやっても「Not a valid mime-type for relation.」という非常に親切なエラーメッセージ。仕方なくNokiaでLifeblogのPC版を落としてインストールし、ポストして、XML on the wireの解析へ。\n\nで、いろいろ変わった実装をしているもんで、どれがキーポイントなのかまた試行錯誤。Lifeblogが生成するAtom entryを見ると、なんと<content>の中身をいわゆるRFC 2045ばりに、72文字という中途半端な数で改行してやがんの。まさか？と思ってそれに対応してみたけど、やっぱりエラーは変わらず。\n\nんで、さらにXMLを眺めてみると、<standalone xmlns=\"http://sixapart.com/atom/typepad#\">1</standalone>という謎の要素を発見。それを挿入してみたらなんと動いちまった。なんてこった。\n\nそういうことで最新バイナリはこちらで最新ソースはこちら。あー、あとFlickrのPOST URLは http://www.flickr.com/services/atom/post/ なんで念のため。リソースには入れてません。\n\n一応書いておきますが、書くまでもなく、こんなのよりFlickrのアップローダのほうが優れています。僕自身Flickrのアップローダつかってます（笑）。まあAtomなんざ「まだ実装すんな」っていう仕様なんで。でも実装がないまま進む仕様化ってのも危険なんで、実装してみるってのに意味はあるかな、と。なんだそりゃ。\n\nこれまでの経緯。\n- [続 AtomAPIPhotoUploader](/blog/-atomapiphotouploader-1/)\n- [改め、AtomAPIPhotoUploader。](/blog/atomapiphotouploader/)\n- [はてなフォトライフアップローダー](/blog/post-43/)\n\nあとついでに発見したのは、NokiaのLifeblog PC版にはCOMAtom.dllというCOMベースのAtom PP実装が含まれてる（と思われる）ってことですね。CreateObject(\"COMAtom.AtomClient\")ってな感じでいけるっぽい。やっぱCOMがキテるらしいってことでオチがつきました。\n\n## Comments:\n\nあーすいません（あやまることでもないんですがｗ\n\n[http://cognections.typepad.com/lifeblog/2004/12/lifeblog_postin.html](http://cognections.typepad.com/lifeblog/2004/12/lifeblog_postin.html)\n\natom:standalone エレメントは Lifeblog 用の atom 拡張で、仕様書の 2.4.1 Posting Lifeblog Items に載っています。\n\n- posted by [miyagawa](https://www.blogger.com/profile/3736463) : 2:02 午前\n\nちょっと前にこういうのつくってました。\n[http://blog.bulknews.net/flickr2typepad.cgi](http://blog.bulknews.net/flickr2typepad.cgi)\n\nこれは flickr から AtomPP (LifeBlog API) をつかって TypePad にポストです。\n\n- posted by [miyagawa](https://www.blogger.com/profile/3736463) : 2:08 午前"},"__N_SSG":true}