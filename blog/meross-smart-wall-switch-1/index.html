<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>壁に埋め込まれている電気のスイッチをHomekit対応のものに入れ替えた</title><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@fumiakiy"/><meta name="og:title" content="壁に埋め込まれている電気のスイッチをHomekit対応のものに入れ替えた"/><meta name="twitter:title" content="壁に埋め込まれている電気のスイッチをHomekit対応のものに入れ替えた"/><meta name="description" content="スマートホーム的な何かをもう少しやってみるために、壁のスイッチを取り替えてみた。"/><meta name="og:description" content="スマートホーム的な何かをもう少しやってみるために、壁のスイッチを取り替えてみた。"/><meta name="twitter:description" content="スマートホーム的な何かをもう少しやってみるために、壁のスイッチを取り替えてみた。"/><link rel="prev" href="https://luckypines.com/blog/meross-smart-wall-switch-1"/><link rel="next" href="https://luckypines.com/blog/job-change-20220516"/><meta name="next-head-count" content="12"/><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-50700-3"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-EQQB7LRDHC"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag("js", new Date());
  gtag("config", "UA-50700-3");
  gtag('config', 'G-EQQB7LRDHC');

  window.twttr = (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0],
      t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);
  
    t._e = [];
    t.ready = function(f) {
      t._e.push(f);
    };
  
    return t;
  }(document, "script", "twitter-wjs"));
  </script><link rel="alternate" type="application/atom+xml" title="Atom feed for blog by Fumiaki Yoshimatsu" href="https://luckypines.com/feed.atom"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/a233f8e7bb0aab01.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a233f8e7bb0aab01.css" data-n-g=""/><link rel="preload" href="/_next/static/css/a85ef328f9b29345.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a85ef328f9b29345.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-486af065e1564901.js" defer=""></script><script src="/_next/static/chunks/pages/_app-3d28606f68ef858c.js" defer=""></script><script src="/_next/static/chunks/664-6863c832d33388a7.js" defer=""></script><script src="/_next/static/chunks/395-8a7e744d27193a7d.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bpostname%5D-b36ac976ecad146c.js" defer=""></script><script src="/_next/static/w12ezk6WF67nUic4mrFs_/_buildManifest.js" defer=""></script><script src="/_next/static/w12ezk6WF67nUic4mrFs_/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap">@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vqPQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_7PqPQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_Of2PQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSV0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSx0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSt0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSd0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSZ0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0me8iUI0.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSV0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSx0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSt0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSd0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSZ0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0me8iUI0.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSV0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSx0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSt0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSd0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSZ0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v22/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0me8iUI0.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><div class="blog"><article class="BlogPost_article__wA_OL"><h1>壁に埋め込まれている電気のスイッチをHomekit対応のものに入れ替えた</h1><div>1/17/2022, 12:24:09 PM</div><div class="BlogPost_body__N7rlb"><h2>序</h2>
<div>クロゼットの電灯を点灯するためのスイッチを、諸般の事情で取り替えてみた。諸般の事情とは、暇なので何かやりたい、なぜかクロゼットの電灯はしょっちゅう点けっぱなしになっている、スマートホーム的なアレでどうにかなるのでは、という三段論法（ではない）である。</div>
<div>以前のエントリーでも触れた通り、この手のスマートホーム化にあたって気にしているのは、GoogleだのAmazonだのに接続しないこと。<a href="/blog/2020-05-23_Sonoff-Basic-R3-------------------f5498b92027b/">理想はローカルネットワークで完結して外には出ないし外からも来ないでほしい</a>。Google AssistantとかAlexaとかは使わないでおきたい。ベッドサイドのランプをアレするのでお世話になったSonoffからも壁に埋め込むスイッチが出ているのだが、これはDIYモードをサポートしておらず、はんだごてを駆使して<a href="https://tasmota.github.io/">Tasmota</a>あたりを焼かないとならない。それはちょっとめんどくさい。</div>
<div>そこでHomekitである。Homekit対応のデバイス同士の通信はローカルで完結することになっている。iCloudへの登録は必要なので完全にローカルではないが、Homekitを使えるなら、<a href="/blog/20200815-m5stickc-http/">Sonoff Basic R3のときに問題になった、Apple Developer Programへのお布施</a>をせずにAppleデバイスから操作ができる。これは妥協できるポイントなのではなかろうか。</div>
<div>ちょっと調べてみると、<a href="https://www.meross.com/product/23/article/">Merossという会社のSmart wall switchがHomekitに対応していて</a>お値段もお安い。こいつでいっちょやってみるかということで、Switchを1つと<a href="https://www.amazon.com/KAIWEETS-Non-Contact-Electrical-Breakpoint-Tester-VT200/dp/B09BQYV2BR/">Voltage tester</a>を買った。</div>
<h2>取り付け</h2>
<div>左がBefore、右がAfter。</div>
<table class="blog-post-table"><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><a href="/images/wall-switch-before.png"><div class="image-container"><img src="/images/wall-switch-before.png" alt="ダサいトグルスイッチ"/><div class="image-caption">ダサいトグルスイッチ</div></div></a></td><td><a href="/images/wall-switch-after.png"><div class="image-container"><img src="/images/wall-switch-after.png" alt="スマートスイッチ"/><div class="image-caption">スマートスイッチ</div></div></a></td></tr></tbody></table>
<div>まずはVoltage testerに電池を入れて、ちゃんと動作するかを試す。具体的には、壁のコンセントのLineの方に突っ込んで通電を検知すること、Neutralの方に突っ込んで通電していない状態を検知すること、さらにブレーカーパネルでそのコンセントのブレーカーを切って、Lineの方でも通電していない状態を検知すること、また元に戻すと通電を検知すること、を確認した。</div>
<div>次にSmart wall switchを開封した。中にはスイッチ本体と化粧パネル以外に、工事中にケーブルに貼って識別しやすくするのであろうステッカーと、ケーブルを接続するスクリューキャップも入っていた。良心的。説明書はネットにも上がっているので事前に読んでおいた。</div>
<div><div class="image-container"><img src="/images/smart-switch-contents.png" alt="内容物"/><div class="image-caption">内容物</div></div></div>
<div>準備ができたのでまずはブレーカーを落としてスイッチへ電気を流さないようにする。壁のスイッチからパネルを外してスイッチを取り出す。この状態でブレーカーで電気を入れて、Voltage testerでLoadとLineを調べる。スイッチをOffにした状態で電気が来ている側がLineで、スイッチをOffにしていると電気は来ないが、Onにすると電気が来る方がLoad。今使っているトグルスイッチにはその手の表示がなく、ワイヤーもカラーコードされていないので（両方とも黒だった）、よく見かける「<a href="https://orro.zendesk.com/hc/en-us/articles/360019870294-If-my-Line-and-Load-wires-are-the-same-color-how-do-I-know-which-is-which-">普通は上がLoadで下がLine</a>」という説を鵜呑みにせず、ちゃんとVoltage testerで調べる。何度かスイッチをOn/Offしたりブレーカーを上げ下げしたりして、Lineに赤、Loadに白の印をつける（付いてきたステッカーはなんかもったいなくて使わなかったw）。</div>
<div><div class="image-container"><img src="/images/voltage-tester.png" alt="電気が来てる"/><div class="image-caption">電気が来てる</div></div></div>
<div>調べ終わったらスクリューからワイヤーを外す。次に、中のスイッチボックスから現時点では使われていなくて素通ししている、ニュートラルのケーブルを取り出す。実はこれもSmart wall switchを買う前にすでにここにあることを確認してあった。というのもSmart wall switchの多くはこのニュートラル配線がないと使えないものもあるからだ。今回買ったものも「Neutral required」とそこかしこに書いてあるので、先に確認してから買わないと。さすがにニュートラルは白いワイヤーだった。よかった。</div>
<table class="blog-post-table"><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><a href="/images/cables-identified.png"><div class="image-container"><img src="/images/cables-identified.png" alt="ケーブル識別後"/><div class="image-caption">ケーブル識別後</div></div></a></td><td><a href="/images/old-switch-removed.png"><div class="image-container"><img src="/images/old-switch-removed.png" alt="スイッチ取り外し"/><div class="image-caption">スイッチ取り外し</div></div></a></td></tr></tbody></table>
<div>あとはSmart wall switchから出ている4本のケーブルを壁から出ている4種類のワイヤーに連結するだけ。このSmart wall switchはケーブルも少し剥いてあったりして良心的。緑(Gnd)を緑とからめてスクリューキャップにねじ込んでネジネジして、引っ張って抜けないことを確認する。白いニュートラルは、付いているスクリューキャップを外して、巻き込まれている電線を少し戻して、Smart wall switchから出ている白いケーブルを巻き込んで再度スクリューキャップをネジネジする。</div>
<div>Smart wall switchには「Lin(黒)」と「Lout(茶)」というケーブルが出ているので、LinをLineと、LoutをLoadと、ネジネジしてつなぐ。このあとスイッチボックスの中にぎゅうぎゅうに押し込むので、押し込んでいる途中で抜けないように引っ張って確認する。</div>
<div><div class="image-container"><img src="/images/cables-connected.png" alt="ケーブル接続完了"/><div class="image-caption">ケーブル接続完了</div></div></div>
<div>この状態でブレーカーをあげて電気を通し、スイッチを押してみてクロゼットの電灯のOn/Offを確認する。緊張の一瞬。問題なくうまく行った。再度ブレーカーを下げて電気を切り、なるべくうまいことケーブルとSmart wall switch本体をスイッチボックスに押し込む。あとはねじ止めしてパネルをはめ込めば完成。</div>
<h2>セットアップ</h2>
<div>Homekitでアクセサリとして登録するために、まずiPadを2.4GhzのWifiにつなぐ。うちにはApple TVやHomepodはないので、iPadをHomekitのハブにする設定も行った。それからSmart wall switch本体に書いてあるHomekit接続用のコードを入力する。最初なんだか失敗して焦ったが、同じことをもう一度やったら登録できた。あとはHomeアプリでタップすれば電灯をOn/Offできる。</div>
<div>Android用にはMerossのアプリがあって、これを使うとHomekitではできない機能（On後指定された時間がたったら自動的にOffにするとか）を使えるようになるのだが、ユーザー登録が必要で、「ローカルで完結」のポリシーに反する。反するが、ファームウェアのアップデートやなんかにも必要になるっぽいので、仕方なく捨てAndroidタブレットに捨てメールアドレスでアカウントを作った。</div>
<h2>まとめ</h2>
<div>事前にある程度まで調べてから買ったこともあって、取り付けやセットアップは概ね問題なくできた。</div>
<div>しかし実は本命はクロゼットの電灯ではなく別のことにあるので、さっそく同じSmart wall switchをもう1つ購入した。続く。</div></div></article></div><footer class="BlogPost_footer__4tSVP"><a class="BlogPost_prev__r_UG_" href="/blog/meross-smart-wall-switch-1/">« <!-- -->壁に埋め込まれている電気のスイッチをHomekit対応のものに入れ替えた</a><a href="/blog/">Blog</a><a class="BlogPost_next__kILUp" href="/blog/job-change-20220516/">転職した<!-- --> » </a></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"slug":"/blog/meross-smart-wall-switch-1","date":"Mon, 17 Jan 2022 20:24:09 GMT","title":"壁に埋め込まれている電気のスイッチをHomekit対応のものに入れ替えた","epoch":"1642451049","excerpt":"スマートホーム的な何かをもう少しやってみるために、壁のスイッチを取り替えてみた。"},"markdownBody":"\n## 序\n\nクロゼットの電灯を点灯するためのスイッチを、諸般の事情で取り替えてみた。諸般の事情とは、暇なので何かやりたい、なぜかクロゼットの電灯はしょっちゅう点けっぱなしになっている、スマートホーム的なアレでどうにかなるのでは、という三段論法（ではない）である。\n\n以前のエントリーでも触れた通り、この手のスマートホーム化にあたって気にしているのは、GoogleだのAmazonだのに接続しないこと。[理想はローカルネットワークで完結して外には出ないし外からも来ないでほしい](/blog/2020-05-23_Sonoff-Basic-R3-------------------f5498b92027b/)。Google AssistantとかAlexaとかは使わないでおきたい。ベッドサイドのランプをアレするのでお世話になったSonoffからも壁に埋め込むスイッチが出ているのだが、これはDIYモードをサポートしておらず、はんだごてを駆使して[Tasmota](https://tasmota.github.io/)あたりを焼かないとならない。それはちょっとめんどくさい。\n\nそこでHomekitである。Homekit対応のデバイス同士の通信はローカルで完結することになっている。iCloudへの登録は必要なので完全にローカルではないが、Homekitを使えるなら、[Sonoff Basic R3のときに問題になった、Apple Developer Programへのお布施](/blog/20200815-m5stickc-http/)をせずにAppleデバイスから操作ができる。これは妥協できるポイントなのではなかろうか。\n\nちょっと調べてみると、[Merossという会社のSmart wall switchがHomekitに対応していて](https://www.meross.com/product/23/article/)お値段もお安い。こいつでいっちょやってみるかということで、Switchを1つと[Voltage tester](https://www.amazon.com/KAIWEETS-Non-Contact-Electrical-Breakpoint-Tester-VT200/dp/B09BQYV2BR/)を買った。\n\n## 取り付け\n\n左がBefore、右がAfter。\n\n|||\n|---|---|\n| [![ダサいトグルスイッチ](/images/wall-switch-before.png)](/images/wall-switch-before.png)| [![スマートスイッチ](/images/wall-switch-after.png)](/images/wall-switch-after.png) |\n\nまずはVoltage testerに電池を入れて、ちゃんと動作するかを試す。具体的には、壁のコンセントのLineの方に突っ込んで通電を検知すること、Neutralの方に突っ込んで通電していない状態を検知すること、さらにブレーカーパネルでそのコンセントのブレーカーを切って、Lineの方でも通電していない状態を検知すること、また元に戻すと通電を検知すること、を確認した。\n\n次にSmart wall switchを開封した。中にはスイッチ本体と化粧パネル以外に、工事中にケーブルに貼って識別しやすくするのであろうステッカーと、ケーブルを接続するスクリューキャップも入っていた。良心的。説明書はネットにも上がっているので事前に読んでおいた。\n\n![内容物](/images/smart-switch-contents.png)\n\n準備ができたのでまずはブレーカーを落としてスイッチへ電気を流さないようにする。壁のスイッチからパネルを外してスイッチを取り出す。この状態でブレーカーで電気を入れて、Voltage testerでLoadとLineを調べる。スイッチをOffにした状態で電気が来ている側がLineで、スイッチをOffにしていると電気は来ないが、Onにすると電気が来る方がLoad。今使っているトグルスイッチにはその手の表示がなく、ワイヤーもカラーコードされていないので（両方とも黒だった）、よく見かける「[普通は上がLoadで下がLine](https://orro.zendesk.com/hc/en-us/articles/360019870294-If-my-Line-and-Load-wires-are-the-same-color-how-do-I-know-which-is-which-)」という説を鵜呑みにせず、ちゃんとVoltage testerで調べる。何度かスイッチをOn/Offしたりブレーカーを上げ下げしたりして、Lineに赤、Loadに白の印をつける（付いてきたステッカーはなんかもったいなくて使わなかったw）。\n\n![電気が来てる](/images/voltage-tester.png)\n\n調べ終わったらスクリューからワイヤーを外す。次に、中のスイッチボックスから現時点では使われていなくて素通ししている、ニュートラルのケーブルを取り出す。実はこれもSmart wall switchを買う前にすでにここにあることを確認してあった。というのもSmart wall switchの多くはこのニュートラル配線がないと使えないものもあるからだ。今回買ったものも「Neutral required」とそこかしこに書いてあるので、先に確認してから買わないと。さすがにニュートラルは白いワイヤーだった。よかった。\n\n|||\n|---|---|\n| [![ケーブル識別後](/images/cables-identified.png)](/images/cables-identified.png)| [![スイッチ取り外し](/images/old-switch-removed.png)](/images/old-switch-removed.png) |\n\nあとはSmart wall switchから出ている4本のケーブルを壁から出ている4種類のワイヤーに連結するだけ。このSmart wall switchはケーブルも少し剥いてあったりして良心的。緑(Gnd)を緑とからめてスクリューキャップにねじ込んでネジネジして、引っ張って抜けないことを確認する。白いニュートラルは、付いているスクリューキャップを外して、巻き込まれている電線を少し戻して、Smart wall switchから出ている白いケーブルを巻き込んで再度スクリューキャップをネジネジする。\n\nSmart wall switchには「Lin(黒)」と「Lout(茶)」というケーブルが出ているので、LinをLineと、LoutをLoadと、ネジネジしてつなぐ。このあとスイッチボックスの中にぎゅうぎゅうに押し込むので、押し込んでいる途中で抜けないように引っ張って確認する。\n\n![ケーブル接続完了](/images/cables-connected.png)\n\nこの状態でブレーカーをあげて電気を通し、スイッチを押してみてクロゼットの電灯のOn/Offを確認する。緊張の一瞬。問題なくうまく行った。再度ブレーカーを下げて電気を切り、なるべくうまいことケーブルとSmart wall switch本体をスイッチボックスに押し込む。あとはねじ止めしてパネルをはめ込めば完成。\n\n## セットアップ\n\nHomekitでアクセサリとして登録するために、まずiPadを2.4GhzのWifiにつなぐ。うちにはApple TVやHomepodはないので、iPadをHomekitのハブにする設定も行った。それからSmart wall switch本体に書いてあるHomekit接続用のコードを入力する。最初なんだか失敗して焦ったが、同じことをもう一度やったら登録できた。あとはHomeアプリでタップすれば電灯をOn/Offできる。\n\nAndroid用にはMerossのアプリがあって、これを使うとHomekitではできない機能（On後指定された時間がたったら自動的にOffにするとか）を使えるようになるのだが、ユーザー登録が必要で、「ローカルで完結」のポリシーに反する。反するが、ファームウェアのアップデートやなんかにも必要になるっぽいので、仕方なく捨てAndroidタブレットに捨てメールアドレスでアカウントを作った。\n\n## まとめ\n\n事前にある程度まで調べてから買ったこともあって、取り付けやセットアップは概ね問題なくできた。\n\nしかし実は本命はクロゼットの電灯ではなく別のことにあるので、さっそく同じSmart wall switchをもう1つ購入した。続く。","navs":{"nextPage":{"epoch":"1652673600","title":"転職した","slug":"/blog/job-change-20220516"},"prevPage":{"epoch":"1642451049","title":"壁に埋め込まれている電気のスイッチをHomekit対応のものに入れ替えた","slug":"/blog/meross-smart-wall-switch-1"}}},"__N_SSG":true},"page":"/blog/[postname]","query":{"postname":"meross-smart-wall-switch-1"},"buildId":"w12ezk6WF67nUic4mrFs_","runtimeConfig":{},"isFallback":false,"gsp":true}</script></body></html>