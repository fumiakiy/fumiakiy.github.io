<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-50700-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {dataLayer.push(arguments); }
    gtag("js", new Date());

    gtag("config", "UA-50700-3");
 </script><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&amp;display=swap" rel="stylesheet"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Unit testing Android app using Robolectric and Android Studio 1.0.1</title><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@fumiakiy"/><meta name="og:title" content="Unit testing Android app using Robolectric and Android Studio 1.0.1"/><meta name="twitter:title" content="Unit testing Android app using Robolectric and Android Studio 1.0.1"/><meta name="next-head-count" content="7"/><link rel="preload" href="/_next/static/css/2fb47489fbb39fde9ffa.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2fb47489fbb39fde9ffa.css"/><link rel="preload" href="/_next/static/css/d86083d51fef5516b5a7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d86083d51fef5516b5a7.css"/><link rel="preload" href="/_next/static/chunks/main-fd8a0b253a51098ec3a6.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-488dc228921f1fdbc0e7.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.1b5fae6dde8a26be77ac.js" as="script"/><link rel="preload" href="/_next/static/chunks/e82d01500e11e0131e78851aa17fd9f5e63d6c88.616ccd5db4903f86882e.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-012ce3de4391df2d9dee.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bpostname%5D-b07b452b8f3bf1c1e2fd.js" as="script"/></head><body><div id="__next"><div class="blog"><article class="BlogPost_article__3W1r-"><h1>Unit testing Android app using Robolectric and Android Studio 1.0.1</h1><div class="BlogPost_body__1oPZH"><pre><code>    </code></pre><div>I have been reluctant to write tests for my Android projects because…</div><ol><li>I didn’t really know what to test. TextView.is.visible.and.hasText(“Hello World”). Er, um.</li><li>I did write some tests as experiments. It runs and start activities in my device. If I didn’t connect my device to my mac, it runs in the emulator. It is slow and it does destruct my focus on writing code.</li></ol><div><a href="http://www.meetup.com/android-developers-nyc/events/219023775/">At one of the greatest meetup experience of any kind that was held at Spotify NYC office by NY Android developers meetup group</a>, I learned less painful ways of doing unit tests for Android dev. <a href="http://robolectric.org/">Robolectric</a>. It allows an Android project to run inside JUnit/IDE. Woot! I have got to try that.</div><div>I thought that Robolectric was mostly a drop-in replacement of a standard Android testing framework that is installed when you create a new project in Android Studio. I was wrong. It took 8 hours worth of my spare time to get it finally working with <!-- -->`<!-- -->gradlew test<!-- -->`<!-- --> inside the Terminal window of Android Studio 1.0.1. It took another 4 hours to figure out running on JUnit test runner inside Android Studio 1.0.1 IDE.</div><div>Instead of writing in a human readable language on how I made it work, I compiled my journey into a stream of commits in my GitHub repository. It should address many if not most of the issues you would be facing if you start doing the same stuff by yourself. I saw a lot of StackOverflow questions about it. Some of them are still applicable to Android Studio 1.0, but many of them were stale (don’t get me wrong. They were really helpful for me to figuring out where to look at. I appreciate it. That is why I list most of them in this writing later).</div><div><a href="https://github.com/fumiakiy/AndroidAppWithRobolectricUnitTestsInAS101">GitHub repository “AndroidAppWithRobolectricUnitTestsInAS101” by fumiakiy</a></div><div>So, try it by yourself (may be with some help from <a href="https://github.com/fumiakiy/AndroidAppWithRobolectricUnitTestsInAS101">my GitHub repository</a>) and enjoy writing unit tests with <a href="http://robolectric.org/">Robolectric</a> inside Android Studio 1.0.1!</div><div>Here is the list of most helpful links that I found during my journey of making it all work.</div><ul><li><div><a href="https://github.com/robolectric/deckard-gradle">https://github.com/robolectric/deckard-gradle</a></div><div>This is the default “installation” suggested by Robolectric. It works. The contents of build.gradle are what I copied to the first half of my “MyApplication” project. But simply importing all gradle settings fails MyApplication because Robolectric currently supports API level 18 and the project Android Studio 1.0.1 creates targets 21.</div></li><li><div><a href="http://stackoverflow.com/questions/23867341/android-robolectric-does-not-support-api-level-1">http://stackoverflow.com/questions/23867341/android-robolectric-does-not-support-api-level-1</a></div><div>This SO is where I found a solution to API level issue. This one also reminded me that there are more than a few configuration you can specify in @Config annotation.</div></li><li><div><a href="https://github.com/square/assertj-android/issues/129#issuecomment-62205520">https://github.com/square/assertj-android/issues/129#issuecomment-62205520</a></div><div>After I added <a href="http://square.github.io/assertj-android/">AssertJ Android</a> (that I also learned at the meetup), I started to see a build error again. This “temporary” solution is still required as of this writing to solve the issue.</div></li><li><div><a href="https://github.com/robolectric/robolectric/issues/1018">https://github.com/robolectric/robolectric/issues/1018</a></div><div>ResourceNotFoundException wasn’t there for the first time I started this “project”, but it was because I changed MainActivity extends from Activity. The default was ActionBarActivity that Android Studio 1.0.1 generates, which raises the ResourceNotFoundException. This thread helped me find “qualifiers” attribute. But the suggested value “v10” didn’t work because I was using suport library 21.0.3 which has “v11”.</div></li><li><div><a href="http://blog.blundell-apps.com/android-gradle-app-with-robolectric-junit-tests/">http://blog.blundell-apps.com/android-gradle-app-with-robolectric-junit-tests/</a> and <a href="http://blog.blundell-apps.com/how-to-run-robolectric-junit-tests-in-android-studio/">http://blog.blundell-apps.com/how-to-run-robolectric-junit-tests-in-android-studio/</a></div><div>After I was satisified with running tests by <!-- -->`<!-- -->gradlew test<!-- -->`<!-- -->, I added JUnit configuration to the project so the tests can run inside IDE with some nice visual and debuggability. It failed in many ways. These tutorials by Blundell helped me a lot to figure out how to run it in the IDE. The document was not for Android Studio 1.0.1 and some information may be stale and not applicable by now (for example, I didn’t have to specify Alt JRE, and I didn’t have to create a “testClasses” gradle configuration), but I wasn’t able to figure out to do it by creating a Java library outside of the app project and refer to the app project from it, without these tutorials.</div></li><li><div><a href="https://github.com/robolectric/robolectric/issues/1334">https://github.com/robolectric/robolectric/issues/1334</a></div><div>I wasn’t able to “reproduce” this particular error when I was compiling my findings one step at a time, but I am sure I was hit by the error. This thread was where I found project.properties can specify libraries to look at. But later I found that you can also put library path to @Config attribute, which was handier for this project.</div></li></ul><div>Thanks to all of you who keeps records of what works and what doesn’t work. Hope this entry and <a href="https://github.com/fumiakiy/AndroidAppWithRobolectricUnitTestsInAS101">my GitHub repository</a> also serve somebody in the future.</div><div>Last but not the least, Thanks <a href="https://docs.google.com/presentation/d/1eF9B9Yi1SIGRxCrKQMhJbCFQQRf3RCuYNk0Ofos5FWE/edit">Sean Kenny who did the presentation at the meetup</a>. I also had to say thanks to <a href="https://docs.google.com/presentation/d/1e2jIRPc03BCfDi8wTWvvtipPsANru4KqbMkhYXfM1AI/edit">Erik Hellman who also did another great presentation at the meetup</a>. OMG, Spotify sounds like a great place to work. Thanks <a href="http://www.meetup.com/android-developers-nyc/">New York Android Developers Meetup</a>. I learned a lot from them.</div></div></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"slug":"/blog/unit-testing-android-app-using-robolectric-and","date":"Tue, 16 Dec 2014 20:16:00 GMT","title":"Unit testing Android app using Robolectric and Android Studio 1.0.1","epoch":"1418760960"},"markdownBody":"        \nI have been reluctant to write tests for my Android projects because…\n\n1.  I didn’t really know what to test. TextView.is.visible.and.hasText(“Hello World”). Er, um.\n2.  I did write some tests as experiments. It runs and start activities in my device. If I didn’t connect my device to my mac, it runs in the emulator. It is slow and it does destruct my focus on writing code.\n\n[At one of the greatest meetup experience of any kind that was held at Spotify NYC office by NY Android developers meetup group](http://www.meetup.com/android-developers-nyc/events/219023775/), I learned less painful ways of doing unit tests for Android dev. [Robolectric](http://robolectric.org/). It allows an Android project to run inside JUnit/IDE. Woot! I have got to try that.\n\nI thought that Robolectric was mostly a drop-in replacement of a standard Android testing framework that is installed when you create a new project in Android Studio. I was wrong. It took 8 hours worth of my spare time to get it finally working with \\`gradlew test\\` inside the Terminal window of Android Studio 1.0.1. It took another 4 hours to figure out running on JUnit test runner inside Android Studio 1.0.1 IDE.\n\nInstead of writing in a human readable language on how I made it work, I compiled my journey into a stream of commits in my GitHub repository. It should address many if not most of the issues you would be facing if you start doing the same stuff by yourself. I saw a lot of StackOverflow questions about it. Some of them are still applicable to Android Studio 1.0, but many of them were stale (don’t get me wrong. They were really helpful for me to figuring out where to look at. I appreciate it. That is why I list most of them in this writing later).\n\n[GitHub repository “AndroidAppWithRobolectricUnitTestsInAS101” by fumiakiy](https://github.com/fumiakiy/AndroidAppWithRobolectricUnitTestsInAS101)\n\nSo, try it by yourself (may be with some help from [my GitHub repository](https://github.com/fumiakiy/AndroidAppWithRobolectricUnitTestsInAS101)) and enjoy writing unit tests with [Robolectric](http://robolectric.org/) inside Android Studio 1.0.1!\n\nHere is the list of most helpful links that I found during my journey of making it all work.\n\n*   [https://github.com/robolectric/deckard-gradle](https://github.com/robolectric/deckard-gradle)\n    \n    This is the default “installation” suggested by Robolectric. It works. The contents of build.gradle are what I copied to the first half of my “MyApplication” project. But simply importing all gradle settings fails MyApplication because Robolectric currently supports API level 18 and the project Android Studio 1.0.1 creates targets 21.\n    \n*   [http://stackoverflow.com/questions/23867341/android-robolectric-does-not-support-api-level-1](http://stackoverflow.com/questions/23867341/android-robolectric-does-not-support-api-level-1)\n    \n    This SO is where I found a solution to API level issue. This one also reminded me that there are more than a few configuration you can specify in @Config annotation.\n    \n*   [https://github.com/square/assertj-android/issues/129#issuecomment-62205520](https://github.com/square/assertj-android/issues/129#issuecomment-62205520)\n    \n    After I added [AssertJ Android](http://square.github.io/assertj-android/) (that I also learned at the meetup), I started to see a build error again. This “temporary” solution is still required as of this writing to solve the issue.\n    \n*   [https://github.com/robolectric/robolectric/issues/1018](https://github.com/robolectric/robolectric/issues/1018)\n    \n    ResourceNotFoundException wasn’t there for the first time I started this “project”, but it was because I changed MainActivity extends from Activity. The default was ActionBarActivity that Android Studio 1.0.1 generates, which raises the ResourceNotFoundException. This thread helped me find “qualifiers” attribute. But the suggested value “v10” didn’t work because I was using suport library 21.0.3 which has “v11”.\n    \n*   [http://blog.blundell-apps.com/android-gradle-app-with-robolectric-junit-tests/](http://blog.blundell-apps.com/android-gradle-app-with-robolectric-junit-tests/) and [http://blog.blundell-apps.com/how-to-run-robolectric-junit-tests-in-android-studio/](http://blog.blundell-apps.com/how-to-run-robolectric-junit-tests-in-android-studio/)\n    \n    After I was satisified with running tests by \\`gradlew test\\`, I added JUnit configuration to the project so the tests can run inside IDE with some nice visual and debuggability. It failed in many ways. These tutorials by Blundell helped me a lot to figure out how to run it in the IDE. The document was not for Android Studio 1.0.1 and some information may be stale and not applicable by now (for example, I didn’t have to specify Alt JRE, and I didn’t have to create a “testClasses” gradle configuration), but I wasn’t able to figure out to do it by creating a Java library outside of the app project and refer to the app project from it, without these tutorials.\n    \n*   [https://github.com/robolectric/robolectric/issues/1334](https://github.com/robolectric/robolectric/issues/1334)\n    \n    I wasn’t able to “reproduce” this particular error when I was compiling my findings one step at a time, but I am sure I was hit by the error. This thread was where I found project.properties can specify libraries to look at. But later I found that you can also put library path to @Config attribute, which was handier for this project.\n    \n\nThanks to all of you who keeps records of what works and what doesn’t work. Hope this entry and [my GitHub repository](https://github.com/fumiakiy/AndroidAppWithRobolectricUnitTestsInAS101) also serve somebody in the future.\n\nLast but not the least, Thanks [Sean Kenny who did the presentation at the meetup](https://docs.google.com/presentation/d/1eF9B9Yi1SIGRxCrKQMhJbCFQQRf3RCuYNk0Ofos5FWE/edit). I also had to say thanks to [Erik Hellman who also did another great presentation at the meetup](https://docs.google.com/presentation/d/1e2jIRPc03BCfDi8wTWvvtipPsANru4KqbMkhYXfM1AI/edit). OMG, Spotify sounds like a great place to work. Thanks [New York Android Developers Meetup](http://www.meetup.com/android-developers-nyc/). I learned a lot from them.\n\n"},"__N_SSG":true},"page":"/blog/[postname]","query":{"postname":"unit-testing-android-app-using-robolectric-and"},"buildId":"wszE4MJpGHP-KveUJCtqu","runtimeConfig":{},"nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-e0a799dda1546678fa28.js"></script><script src="/_next/static/chunks/main-fd8a0b253a51098ec3a6.js" async=""></script><script src="/_next/static/chunks/webpack-488dc228921f1fdbc0e7.js" async=""></script><script src="/_next/static/chunks/framework.1b5fae6dde8a26be77ac.js" async=""></script><script src="/_next/static/chunks/e82d01500e11e0131e78851aa17fd9f5e63d6c88.616ccd5db4903f86882e.js" async=""></script><script src="/_next/static/chunks/pages/_app-012ce3de4391df2d9dee.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bpostname%5D-b07b452b8f3bf1c1e2fd.js" async=""></script><script src="/_next/static/wszE4MJpGHP-KveUJCtqu/_buildManifest.js" async=""></script><script src="/_next/static/wszE4MJpGHP-KveUJCtqu/_ssgManifest.js" async=""></script></body></html>